---
title:  "코드 리펙토링"
date:   2015-02-15 22:19:00
categories: refactoring
---

### 리펙토링

프로젝트 3주차 즈음 코드 리펙토링 교육을 받았다.

리펙토링이란
-  소프트웨어를 보다 쉽게 이해할 수 있고
-  적은 비용으로 수정할 수 있도록
-  겉으로 보이는 동작의 변화 없이
-  소프트웨어의 내부적인 구조를 변경하는 것
-  Improving the design of existing code

나쁜 코드와 좋은 코드를 배웠다. 리펙토링은 나쁜 코드를 좋은 코드로 바꾸는 작업이다. 리펙토링의 대상이 되는 나쁜 코드는, 몇가지 냄새가 난다. 
-  중복된 코드
-  긴 메쏘드
-  산탄총 수술
-  미들맨 등

![1](http://blog.codinghorror.com/content/images/uploads/2009/02/6a0120a85dcdae970b012877707a45970c-pi.png)

냄새나는 코드를 더 개선할 여지가 없는지 살펴보고, 보다 나은 코드로 고쳐야 한다.
가장 쉽게 저지르기 쉬운 나쁜 코드는 바로 중복된 코드이다. 같은 코드가 3번이상 나오면 메소드로 뽑아내거나, 구조적으로 변경하여 중복된 코드가 없도록 개선해야 한다. 중복된 코드의 비효율적인 점 뿐만 아니라, 이후 중복된 코드 부분을 수정하게 될경우, 이른바 산탄총 수술과 같은 비효율적인 작업이 발생한다.

프로젝트의 순수 java코드 라인수의 변화를 기록해보았다.

| 빌드번호 |  LOC  |   비고        |
|----------|-------|---------------|
|   #15    | 3021  | 리펙토링 직전 | 
|   #80    | 2750  | 리펙토링 직후 |
|   #110   | 2676  |     기능 추가 |
|   #140   | 2923  |     기능 추가 |
|   #180   | 2918  |     기능 추가 |

`#15`가 리펙토링 직전의 코드이다. 이후부터 코드 리펙토링을 하였고, 일주일 후인 `#110`에서 코드 라인 수가 400라인정도 줄어들었다. 분명 디버깅, 기능개선작업도 병행하였지만 코드 라인수가 더 줄었음을 볼 수 있다. 중복코드 제거, 구조 개선 등이 코드 라인수의 감소의 주된 이유였을 것이다. 
리펙토링 교육을 바탕으로 이후에도 꾸준히 리펙토링하였으나, 다시 리펙토링 이전의 라인수로 늘어났다. 기능 추가 및 좀 더 많은 예외 처리 코드 때문으로 추측된다.

리펙토링에서의 `좋은 코드`는 비단 코드 라인수로만 판단할 순 없다. 하지만 분명 리펙토링 교육 이후 일주일간 약 400라인정도가 줄어들었음을 확인할 수 있었다. 주석 처리된 더 이상 사용하지 않는 코드의 제거도 리펙토링의 요소 중 하나인데, 라인수 감소에 가장 큰 공을 세운것이 아닌가 하는 생각이 든다.




